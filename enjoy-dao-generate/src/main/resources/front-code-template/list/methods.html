<th:block th:fragment="parts">
<script th:inline="javascript">
    var moduleApi = /*[[${moduleApi}]]*/ "";
    var moduleCode = /*[[${moduleCode}]]*/ "";
    methods.loadPageData = function(pageNo) {
        var param = {
            systemId: store.systemId,
            keyword: store.keyword,
            pageNo: pageNo,
            pageSize: 15
        };
        httpClient.postJson(`/${moduleApi}/queryPage`,  param ,function(op){
            if (!op.success){
                window.vue.$Notice.error({title: '{{SystemError}}', desc: op.message})
                setTimeout(function (){
                    window.vue.$Loading.error();
                }, 100)
                return;
            }
            store.rows = op.data.rows;
            store.totalSize = op.data.totalSize;
        })
        store.pageNo = pageNo;
    }
    methods.addNew = function() {
        window.parent.callCommForm("{{AddLabel}}", `/${moduleCode}/edit`, 500, 500)
    }
    methods.edit = function(row) {
        window.parent.callCommForm("{{ModifyLabel}}", `/${moduleCode}/edit?id=${row.id}`, 500, 500)
    }
    methods.delete = function(row) {
        var param = {
            ids: [row.id]
        }
        window.parent.confirmForm("{{HintLabel}}", "{{ConfirmDeleteRowHint}}", function(){
            httpClient.postJson(`/${moduleApi}/delete`,  param ,function(op){
                if (!op.success){
                    window.vue.$Notice.error({title: '{{SystemError}}', desc: op.message})
                    setTimeout(function (){
                        window.vue.$Loading.error();
                    }, 100)
                    return;
                }
                window.vue.$Notice.info({title: '{{DeleteSuccessHint}}'})
                methods.loadPageData(store.pageNo)
            })
        })
    }
    methods.save = function() {
        httpClient.postJson(`/${moduleApi}/save`, store.formItem ,function(op){
            if (!op.success){
                window.vue.$Notice.error({title: '{{SystemError}}', desc: op.message})
                setTimeout(function (){
                    window.vue.$Loading.error();
                }, 100)
                return;
            }
            window.vue.$Notice.info({title: '{{SaveSuccess}}'})
            store.modalEdit = false
            methods.loadPageData(store.pageNo)
        })
    }
    methods.cancel = function() {

    }
    methods.pageChange = function (pageNo) {
        methods.loadPageData(pageNo);
    };

</script>
</th:block>